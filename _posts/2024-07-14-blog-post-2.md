---
title: 'Solution of Count Arithmetic Subsequences [abc362 E]'
date: 2024-07-14
permalink: /posts/2024/08/blog-post-2/
tags:
  - Dynamic Programming
  - Coordinate Compression
---

Problem: [Count Arithmetic Subsequences](https://atcoder.jp/contests/abc362/tasks/abc362_e)\
In this problem,\
we are asked to find for each \\(K = 1, 2, \ldots, N\\) , the number (mod \\(998244353\\)) of subsequences of \\(A\\)\
of length \\(K\\) that are arithmetic sequences.


An arithmetic sequence is a sequence of numbers where the differences between every two consecutive 
terms is the same.\
An important thing to notice here is that \\(1 \leq N \leq 80\\).\
So, there can be at most \\(\binom{80}{2} = 3160\\) different differences.\
We can find these differences in \\(\mathcal{O}(N^2)\\) and then we can count the number of\
arithmetic subsequence in \\(A\\) having these differences using dynamic programming.\
Let's define our *dp* as,\
\\(dp(i, l, d) = \\) **number of arithmetic subsequence ending at i, have length l and difference d**\
Base case: \\(dp(i, 1, d) = 1\\) for all \\(i\\) and \\(d\\)\
Transitions:\
\\[ 
dp(i, l, d) = \sum_{\substack{j=1 \\ A[j] + d = A[i]}}^{i-1} dp(j, l-1, d) 
\\]


TODO: finish this editorial tomorrow (15-7-24)